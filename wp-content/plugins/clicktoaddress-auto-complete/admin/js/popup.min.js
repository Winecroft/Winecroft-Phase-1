function get_cc_token(a){cc_obj={},cc_obj.callback=a,cc_obj.token="",cc_obj.url="https://account-api.craftyclicks.co.uk/",cc_obj.login_details={},cc_obj.access_tokens=[],cc_obj.make_popup=function(){var a=jQuery('<div id="crafty-background"><div id="crafty-content"><div id="craftyCloseButton"><svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 490 490" style="enable-background:new 0 0 490 490;" xml:space="preserve"><g><g><g><path d="M207,182.8c-6.7-6.7-17.6-6.7-24.3,0s-6.7,17.6,0,24.3l38,38l-38,38c-6.7,6.7-6.7,17.6,0,24.3c3.3,3.3,7.7,5,12.1,5 c4.4,0,8.8-1.7,12.1-5l38-38l38,38c3.3,3.3,7.7,5,12.1,5s8.8-1.7,12.1-5c6.7-6.7,6.7-17.6,0-24.3l-38-38l38-38 c6.7-6.7,6.7-17.6,0-24.3s-17.6-6.7-24.3,0l-38,38L207,182.8z"/><path d="M0,245c0,135.1,109.9,245,245,245s245-109.9,245-245S380.1,0,245,0S0,109.9,0,245z M455.7,245 c0,116.2-94.5,210.7-210.7,210.7S34.3,361.2,34.3,245S128.8,34.3,245,34.3S455.7,128.8,455.7,245z"/></g></g></g></svg></div><img src="https://craftyclicks.co.uk/wp-content/themes/craftyclicks_wp_theme/assets/img/headerimg.png" alt="Crafty Clicks" style="width:345px;height:54px;"><div id="craftyErrorDisplay"></div><form id="craftyForm"><h3>Log in to your Crafty Clicks account</h3><input id="cc-user" placeholder="Email"><input id="cc-password" type="password" placeholder="Password"></input><input id="craftyLoadButton" class="cc-button-lg" value="Load Tokens"></input></form><div id="craftyLoadingImg" style="display: none;"><svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"viewBox="0 0 24 30" style="enable-background:new 0 0 50 50;" xml:space="preserve"><rect x="0" y="10" width="4" height="10" fill="#333" opacity="0.2"><animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0s" dur="0.6s" repeatCount="indefinite" /></rect><rect x="8" y="10" width="4" height="10" fill="#333"  opacity="0.2"><animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0.15s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0.15s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0.15s" dur="0.6s" repeatCount="indefinite" /></rect><rect x="16" y="10" width="4" height="10" fill="#333"  opacity="0.2"><animate attributeName="opacity" attributeType="XML" values="0.2; 1; .2" begin="0.3s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="height" attributeType="XML" values="10; 20; 10" begin="0.3s" dur="0.6s" repeatCount="indefinite" /><animate attributeName="y" attributeType="XML" values="10; 5; 10" begin="0.3s" dur="0.6s" repeatCount="indefinite" /></rect></svg></div><div id="craftyResultDisplay" style="display: none"><h4>Your access tokens:</h4><table><thead><tr><td>ID</td><td>Token</td><td>Alias</td></tr></thead><tbody></tbody></table></div></div></div>');jQuery("body").append(a),jQuery("#craftyCloseButton").on("click",function(){cc_obj.close_popup()}),jQuery("#craftyLoadButton").on("click",function(a){cc_obj.loading(),setTimeout(function(){cc_obj.authenticate()},500)})},cc_obj.close_popup=function(){jQuery("#crafty-background").remove()},cc_obj.authenticate=function(){cc_obj.login_details.user=jQuery("#cc-user").val(),cc_obj.login_details.password=jQuery("#cc-password").val();var a=new XMLHttpRequest;a.open("GET",cc_obj.url+"access/token",!0),a.setRequestHeader("CRAFTY-CLICKS-APPLICATION-KEY","woocommerce-plugin"),a.setRequestHeader("Authorization","Basic "+btoa(cc_obj.login_details.user+":"+cc_obj.login_details.password)),a.send(),a.onreadystatechange=function(){if(4==a.readyState&&200==a.status){var b=JSON.parse(this.responseText);cc_obj.account_id=b.user_info.account_id;var c=new XMLHttpRequest;c.open("GET",cc_obj.url+"ws_tokens/get?account_id="+cc_obj.account_id,!0),c.setRequestHeader("CRAFTY-CLICKS-APPLICATION-KEY","woocommerce-plugin"),c.setRequestHeader("Authorization","Basic "+btoa(cc_obj.login_details.user+":"+cc_obj.login_details.password)),c.send(),c.onreadystatechange=function(){if(4==c.readyState&&200==c.status){var a=JSON.parse(this.responseText);if(a.ws_tokens.length){for(var b=0;b<a.ws_tokens.length;b++)!a.ws_tokens[b].deleted&&a.ws_tokens[b].enabled&&(cc_obj.access_tokens[b]={token_id:a.ws_tokens[b].token_id,access_token:a.ws_tokens[b].token,nickname:a.ws_tokens[b].nickname});cc_obj.display_token_list()}else cc_obj.error("No access tokens were found for this account.")}else 4==c.readyState&&200!=c.status&&cc_obj.error("Unable to retrieve access tokens as an error occurred. Please try again.")}}else 4==a.readyState&&401==a.status?cc_obj.error("There was a problem with the details you provided. Please try again."):4==a.readyState&&200!=a.status&&cc_obj.error("Unable to retrieve access tokens as an error occurred. Please try again.")}},cc_obj.loading=function(){jQuery("#craftyForm").css({display:"none"}),jQuery("#craftyLoadingImg").show()},cc_obj.display_token_list=function(){if(jQuery("#craftyLoadingImg").hide(),cc_obj.access_tokens.length){jQuery("#craftyErrorDisplay").hide(),jQuery("#craftyResultDisplay").show();for(var a="",b=0;b<cc_obj.access_tokens.length;b++)void 0!==cc_obj.access_tokens[b]&&(a+='<tr data-token="'+cc_obj.access_tokens[b].access_token+'"><td>'+cc_obj.access_tokens[b].token_id+"</td><td>"+cc_obj.access_tokens[b].access_token+"</td><td>"+cc_obj.access_tokens[b].nickname+"</td></tr>");jQuery("#craftyResultDisplay").find("tbody")[0].innerHTML=a,jQuery("#craftyResultDisplay").find("tr").each(function(a,b){jQuery(b).on("click",function(){cc_obj.callback(b.getAttribute("data-token")),cc_obj.close_popup()})})}else cc_obj.error("No access tokens were found for this account.")},cc_obj.error=function(a){jQuery("#craftyLoadingImg").hide(),jQuery("#craftyForm").show(),jQuery("#craftyErrorDisplay").show(),document.getElementById("craftyErrorDisplay").innerHTML=a},cc_obj.make_popup()}
